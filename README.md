# nmapper_ultra
Nmap PyDumpPlus is an append-only, staged Nmap pipeline that discovers open ports, runs targeted follow-up scans (aggressive/service and UDP probes), and produces structured outputs (CSV, per-port/service files, and a simple HTML dashboard) to speed recon and keep results consistent across runs.

## Features

* Staged scans per target to avoid redundant work:

  1. TCP full-port discovery (`-p- -T4 -sS`)
  2. TCP targeted aggressive/service scan on discovered TCP ports (`-T4 -sC -sV -A -p <ports>`) — `--include-os` adds `-O`
  3. UDP full-port discovery (`-sU -p- -T3`)
  4. UDP targeted service/version probing on discovered UDP ports (`-sU -sV -p <ports>`) with retry/backoff options
* Append-only live updates: outputs are incrementally updated as XMLs finish; `state.json` prevents duplicates across runs
* Default behavior runs full-port discovery and aggressive follow-ups for TCP each run
* `--discovery-only` option (skip follow-ups), `--rebuild` to regenerate outputs from XMLs
* Simple static dashboard (`webHTML/dashboard.html`) and optional `--serve-dashboard` to host on port 8000
* Progress indicator in terminal (jobs completed, hosts/ports/services counts)

## Prerequisites

* `nmap` installed and available on PATH
* Python 3.8+ recommended
* Elevated privileges may be required for UDP scans / SYN scans on some platforms

## Quickstart

1. Place the script `nmapPyDumpPlus_with_scanner.py` in a working directory.
2. Make it executable (optional):

```bash
chmod +x nmapPyDumpPlus_with_scanner.py
```

3. Run a default staged scan (targets file should contain one target per line):

```bash
python3 nmapPyDumpPlus_with_scanner.py --targets-file targets.txt --outputDir ./pyDumpOutput
```

## Common options

* `--targets-file` : path to file with targets (one per line) or a single target string
* `--targets` : comma-separated targets
* `--outputDir` : output directory (default: `pyDumpOutput`)
* `--parallel` : number of parallel target workers
* `--discovery-only` : run discovery stages only (skip follow-ups)
* `--include-os` : include OS detection (`-O`) in the aggressive TCP scan
* `--udp-delay`, `--udp-backoff`, `--udp-retries` : tune UDP retry/backoff behavior
* `--rebuild` : rebuild outputs from XMLs in `outputDir/nmap_xml`
* `--serve-dashboard` : serve `outputDir` on port 8000 for live viewing

## Output layout

```
pyDumpOutput/
├─ nmap_xml/                   # raw XML files from each stage
├─ ports/                      # file per port listing IPs
├─ services/                   # file per service listing IP:port
├─ versions/                   # file per version listing IPs
├─ servicesWithPorts/          # files named service_port -> IPs
├─ webHTML/
│  ├─ parsedWebServers.html
│  ├─ http.url.list
│  ├─ https.url.list
│  └─ dashboard.html
├─ all.ports.up.csv
├─ all.up.csv
├─ ips.up.list
├─ hostnames.up.list
└─ state.json                  # append-only state persisted between runs
```

## Rebuild

To regenerate outputs from saved XMLs:

```bash
python3 nmapPyDumpPlus_with_scanner.py --outputDir ./pyDumpOutput --rebuild
```

## Safety & operational notes

* Only scan targets you are authorized to test. The script no longer enforces an interactive permission flag — you are responsible for following ROE.
* Aggressive scans (`-A`) and UDP probing can be intrusive and noisy. Use `--discovery-only` or limit targets/ports for low-impact runs.
* UDP scanning is slow; tune `--udp-delay`, `--udp-backoff`, and `--udp-retries` as needed.

## Examples

```bash
# Full staged run for targets in a file
python3 nmapPyDumpPlus_with_scanner.py --targets-file targets.txt --outputDir ./pyDumpOutput

# Include OS detection in aggressive stage
python3 nmapPyDumpPlus_with_scanner.py --targets-file targets.txt --outputDir ./pyDumpOutput --include-os

# Discovery-only (fast census)
python3 nmapPyDumpPlus_with_scanner.py --targets-file targets.txt --outputDir ./pyDumpOutput --discovery-only

# Rebuild from existing XMLs
python3 nmapPyDumpPlus_with_scanner.py --outputDir ./pyDumpOutput --rebuild

# Serve dashboard and run in parallel
python3 nmapPyDumpPlus_with_scanner.py --targets-file targets.txt --outputDir ./pyDumpOutput --parallel 3 --serve-dashboard
```

## Next improvements (ideas)

* Limit UDP to a configurable port range for faster runs
* Simple token-based protection for the dashboard
* Optional `python-nmap` backend mode for programmatic control

## License

Use under your organization’s policies. No warranty provided.

---

*README.md generated by your assistant.*
